<!DOCTYPE html>
<html>
<head>
    {{template "shared_head"}}
    <title>/jank/{{.Board.Name}}/</title>
    <style>
        {{template "shared_styles"}}
        .container {
            max-width: 800px;
        }
        .board-title {
            font-size: 1.8em;
            margin-bottom: 5px;
            color: #343a40;
        }
        .board-meta {
            color: #6c757d;
            margin-bottom: 20px;
        }
        .threads {
            list-style-type: none;
            padding: 0;
        }
        .thread {
            border-bottom: 1px solid #ddd;
            padding: 15px 0;
        }
        .thread:last-child {
            border-bottom: none;
        }
        .thread-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .thread-title {
            font-weight: bold;
            color: #343a40;
        }
        .thread-date {
            color: #6c757d;
            font-size: 0.9em;
        }
        .thread-author {
            color: #6c757d;
            font-size: 0.9em;
        }
        footer {
            margin-top: 40px;
        }
        @media (max-width: 600px) {
            .thread-header {
                flex-direction: column;
                align-items: flex-start;
            }
            .thread-date {
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    {{template "site_header" (printf "/jank%s" .Board.Name)}}

    <div class="container">
        {{template "auth_bar" .}}
        <div class="board-title">{{.Board.Name}} (Board #{{.Board.ID}})</div>
        <div class="board-meta">{{.Board.Description}}</div>

        {{if .IsAuthenticated}}
            <a href="/view/board/newthread/{{.Board.ID}}">Create a new thread</a>
        {{else}}
            <a href="/login?next={{.CurrentPath | urlquery}}">Log in to create a new thread</a>
        {{end}}

        <h2>Threads</h2>
        {{if .Board.Threads}}
            <ul class="threads">
            {{range .Board.Threads}}
                <li class="thread">
                    <div class="thread-header">
                        <div class="thread-title"><a href="/view/thread/{{.ID}}">Thread #{{.ID}}: {{.Title}}</a></div>
                        <div class="thread-date">Created: {{.Created.Format "Jan 2, 2006 at 3:04pm"}}</div>
                    </div>
                    {{if .Author}}
                        <div class="thread-author">Started by <a href="/user/{{.Author | urlquery}}">{{.Author}}</a></div>
                    {{end}}
                </li>
            {{end}}
            </ul>
        {{else}}
            <p>No threads yet. Be the first to create one!</p>
            {{if .IsAuthenticated}}
                <p><a href="/view/board/newthread/{{.Board.ID}}">Start a new thread</a></p>
            {{else}}
                <p><a href="/login?next={{.CurrentPath | urlquery}}">Log in to start a thread</a></p>
            {{end}}
        {{end}}

        {{template "footer_home" .}}
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const threadTitles = document.querySelectorAll('.thread-title a');
            const boardTitle = document.querySelector('.board-title');
            const boardMeta = document.querySelector('.board-meta');
            const cardNamePattern = /\[\[([^\]]+)\]\]/g;

            threadTitles.forEach(title => {
                title.innerHTML = title.innerHTML.replace(cardNamePattern, '<span class="mtg-card">[[ $1 ]]</span>');
            });

            if (boardTitle) {
                boardTitle.innerHTML = boardTitle.innerHTML.replace(cardNamePattern, '<span class="mtg-card">[[ $1 ]]</span>');
            }

            if (boardMeta) {
                boardMeta.innerHTML = boardMeta.innerHTML.replace(cardNamePattern, '<span class="mtg-card">[[ $1 ]]</span>');
            }
        });
    </script>
</body>
</html>
