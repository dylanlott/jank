<!DOCTYPE html>
<html>
<head>
    {{template "shared_head"}}
    <title>/jank/ - moderation queue</title>
    <style>
        {{template "shared_styles"}}
        .container {
            max-width: 900px;
        }
        .report-list {
            display: grid;
            gap: 16px;
        }
        .report-card {
            border: 1px solid var(--color-border-soft);
            border-radius: 8px;
            padding: 16px;
            background: var(--color-surface-alt);
            box-shadow: 0 6px 18px var(--color-shadow);
        }
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            flex-wrap: wrap;
        }
        .report-title {
            font-weight: 700;
            color: var(--color-text-strong);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 0.85em;
        }
        .report-meta {
            color: var(--color-text-muted);
            font-size: 0.9em;
        }
        .report-links {
            margin-top: 8px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .report-body {
            margin-top: 12px;
            padding: 12px;
            border-radius: 8px;
            background: var(--color-surface);
            border: 1px solid var(--color-border-softer);
        }
        .report-content {
            white-space: pre-wrap;
            margin-top: 6px;
        }
        .report-note {
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--color-text-muted);
        }
        .report-actions {
            margin-top: 12px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .report-actions form {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }
        .report-actions input[type="text"] {
            min-width: 220px;
            margin: 0;
        }
        .report-actions button {
            background: var(--color-primary);
            color: #fff;
            border: none;
            padding: 8px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        .report-actions button:hover {
            background: var(--color-primary-hover);
        }
        .report-actions .danger button {
            background: var(--color-danger);
        }
    </style>
</head>
<body>
    {{template "site_header" "/jank/mod/"}}

    {{template "klaxon_banner" .}}

    <div class="container">
        {{template "auth_bar" .}}

        <h2>Report queue</h2>
        {{if .Reports}}
            <div class="report-list">
                {{range .Reports}}
                    <div class="report-card">
                        <div class="report-header">
                            <div class="report-title">#{{.ID}} · {{.Category}}</div>
                            <div class="report-meta">Reported {{.Created.Format "Jan 2, 2006 at 3:04pm"}}{{if .ReportedBy}} by {{.ReportedBy}}{{end}}</div>
                        </div>
                        <div class="report-links">
                            <a href="/view/thread/{{.ThreadID}}#post-{{.PostID}}">View post</a>
                            <span class="muted">/{{.BoardName}}/ · {{.ThreadTitle}}</span>
                        </div>
                        <div class="report-body">
                            <div class="muted">Post by {{.PostAuthor}} on {{.PostCreated.Format "Jan 2, 2006 at 3:04pm"}}{{if .PostDeleted}} · removed{{end}}</div>
                            <div class="report-content">{{if .PostContent}}{{markdown .PostContent}}{{else}}(no content){{end}}</div>
                            {{if .PostDeletedReason}}
                                <div class="report-note">Removal reason: {{.PostDeletedReason}}</div>
                            {{end}}
                            {{if .Reason}}
                                <div class="report-note">Reporter note: {{.Reason}}</div>
                            {{end}}
                        </div>
                        <div class="report-actions">
                            <form method="POST" action="/mod/reports/{{.ID}}/resolve">
                                <input type="text" name="note" placeholder="Resolution note (optional)" />
                                <button type="submit">Resolve</button>
                            </form>
                            {{if .PostDeleted}}
                            {{else}}
                                <form class="danger" method="POST" action="/mod/posts/{{.PostID}}/delete">
                                    <input type="hidden" name="next" value="/mod/reports" />
                                    <input type="text" name="reason" placeholder="Removal reason" required />
                                    <button type="submit">Soft delete</button>
                                </form>
                            {{end}}
                        </div>
                    </div>
                {{end}}
            </div>
        {{else}}
            <p class="muted">No open reports. Enjoy the quiet.</p>
        {{end}}

        {{template "footer_home" .}}
    </div>
</body>
</html>
